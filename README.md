# Optimizing Hybrid Models for Canopy Nitrogen Mapping from Sentinel-2 in Google Earth Engine

## Abstract

Canopy nitrogen content (CNC) is a crucial variable for plant health, influencing photosynthesis and growth. An optimized, scalable approach for spatially explicit CNC quantification using Sentinel-2 (S2) data is presented, integrating PROSAIL-PRO simulations with Gaussian Process Regression (GPR) and an Active Learning technique, specifically the Euclidean distance-based diversity (EBD) approach for selective sampling. This hybrid method enhances training dataset efficiency and optimizes CNC models for practical applications.
Two GPR models based on PROSAIL-PRO variables were evaluated: a protein-based model (Cprot-LAI) and a chlorophyll-based model (Cab-LAI). Both models, implemented in Google Earth Engine (GEE), demonstrated strong performance and outperformed other machine learning methods, including kernel ridge regression, principal component regression, neural network, weighted k-nearest neighbours regression, partial least squares regression and least squares linear regression. 
Validation results showed moderate to good accuracies: NRMSE_Cprot-LAI = 16.76%, R2_Cprot-LAI = 0.47; NRMSE_Cab-LAI = 18.74%, R2_Cab-LAI = 0.51. The models revealed high consistency for an independent validation dataset of the Munich-North-Isar (Germany) test site, with R-squared values of 0.58 and 0.71 and NRMSEs of 21.47% and 20.17% for the Cprot-LAI model and Cab-LAI model, respectively. 
The models also demonstrated high consistency across growing seasons, indicating their potential for time series analysis of CNC dynamics. Application of the S2-based mapping workflow across the Iberian Peninsula, with estimates showing relative uncertainty below 30%, highlights the model's broad applicability and portability. The optimized EBD-GPR-CNC approach within GEE supports scalable CNC estimation and offers a robust tool for monitoring nitrogen dynamics.
